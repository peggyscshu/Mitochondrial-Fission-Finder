# Mitochondrial-Fission-Finder
![image](https://github.com/user-attachments/assets/52fc410a-733f-4bee-aba5-e5005c6a2f98)


## Introduction

" Mitochondrial Fission Finder" is a ImageJ[^1] macro developed to identify mitochondrial fission events from time-series datasets. The workflow first labels individual mitochondria, then tracks fission events across consecutive frames, and finally pairs daughter mitochondria with their parent. The macro is designed for time-lapse, multi-channel images that include mitochondrial matrix, fission protein (Drp1), and biosensor channels.

## Examples
The mitochondrial multi-channel confocal images, captured by Chieh-Ju Alex Sung, are provided courtesy of Dr. Ya-Wen Liu, Institute of Molecular Medicine, College of Medicine, National Taiwan University. The image is composed of three channels in the following order—Mito matrix, Drp1, and biosensor. To ensure correct quantification, please arrange your input image in the same order.

## Description 

**I. Generate Mito Mask and Identify Individual Mitochondria**

1. Duplicate the first channel (Mito matrix marker) and rename it as "Mito" for further analysis.
2. Apply bleach correction via Histogram Matching to the duplicated "Mito" image to compensate for photobleaching.
3. The mitochondrial mask, named "Bleach Corrected Mito Mask", is generated by applying a median filter, background subtraction, followed by auto local thresholding using the Phansalkar method[^3]. 
4. To avoid overgrowth of masked mitochondria due to bleach correction, the contours of masked mitochondria are refined by the second mask (Mito_Simple Mask), generated by binarizing the raw image with the default threshold method. 
5. The ROI list and labeled mitochondrial image are analyzed and saved in the same folder as the input image.


**II. Fission Event Detection**
1. Fission events are determined by iteratively comparing mitochondrial number between frame t and frame t+1 in the same ROI region.
2. If fission events were detected, the daughter number and labels of both daughter and parent mitochondria will be recorded in the table named "Mito.csv". 

**III. Fission Pair Extraction**
1. Three images corresponding to frames t–1, t, and t+1, where a fission event occurs at frame t, are extracted and aligned into a mosaic image.
2. The parental mitochondrion is outlined at frames t-1 and t, while the daughter mitochondria are drawn at the frame t+1 for further validation. 
3. Each daughter-parent pair is extracted and stacked into a new dataset.
4. Since the setting of brightness and contrast should be applied independently for each channel, the above steps are repeated for each channel to generate three result image stacks.
5. All result image stacks are saved in the same folder as the input image.

**IV. Check the result**
1. Synchronize the result stacks by selecting "Synchronize Windows" under the menu "Analyze\Tools".
2. Adjust brightness and contrast for each channel via "Image\Adjust\Brighness/Contrast".
3. Open the ROI list and Mito.csv table aside for cross validation. 

## Instruction
**I. File Requirements**
1. It supports .czi, .lsm, and .tif formats.
2. Store the input image on a local drive to enable building a folder for saving result data automatically. 

**II. Running the Macro**
1. Install Fiji is just ImageJ. https://fiji.sc/
2. Download the IJM script " Mitochondrial Fission Finder".
3. Launch the Fiji software.
4. Open the input image and the script " Mitochondrial Fission Finder".
5. Run the script.
6. The final output will include:
   - fission analysis table (Mito.csv)
   - mitochondrial ROI zip file
   - labeled mitochondrial image
   - three sequence images for each channel

     
  ![image](https://github.com/user-attachments/assets/c346be2e-a03f-497b-a0e4-35dfc3be58e9)
**The workflow of "Mitochondrial Fission Finder"**


## Acknowledgements
We thank Mr.Chieh-Ju Alex Sung and Dr. Ya-Wen Liu for providing the demonstration images used during the development of this workflow.

## References

[^1]: Schindelin, J., Arganda-Carreras, I., Frise, E., et al. (2012). Fiji: an open-source platform for biological-image analysis. Nature Methods, 9(7), 676–682. https://doi.org/10.1038/nmeth.2019
[^2]: Kleele, T., Rey, T., Winter, J. et al. Distinct fission signatures predict mitochondrial degradation or biogenesis. Nature 593, 435–439 (2021). https://doi.org/10.1038/s41586-021-03510-6
[^3]: Phansalkar, N., More, S., Sabale, A., & Joshi, M. (2011). Adaptive local thresholding for detection of nuclei in diversity stained cytology images. In 2011 International Conference on Communications and Signal Processing (pp. 218–220). IEEE. https://doi.org/10.1109/ICCSP.2011.5739305


